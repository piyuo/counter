import 'package:flutter/material.dart';
import 'package:oktoast/oktoast.dart';
import 'package:provider/provider.dart';

import 'package:counter/src/signin/signin_provider.dart.bak';

class LoginButton extends StatelessWidget {
  final nameController;

  LoginButton(this.nameController);

  onFormSubmit(BuildContext ctx, SigninProvider signin) {
    var formState = Form.of(ctx);
    if (formState.validate()) {
      signin.submit(ctx, nameController.text).then((value) {
        if (value) {
          Navigator.of(ctx).pop(true);
        } else {
          showToast('cannot sign in');
        }
      });
    }
  }

  @override
  Widget build(BuildContext context) {
    return Consumer<SigninProvider>(
        builder: (context, signin, _) => LoginButtonWidget(
              child: signin.busy
                  ? Text('nonono')
                  : Text(
                      'Sign in',
                      style: Theme.of(context)
                          .accentTextTheme
                          .headline6
                          .copyWith(wordSpacing: 0),
                    ),
              onPressed:
                  signin.busy ? null : () => onFormSubmit(context, signin),
            ));
  }
}

class LoginButtonWidget extends StatelessWidget {
  final Widget child;
  final VoidCallback onPressed;

  LoginButtonWidget({this.child, this.onPressed});

  @override
  Widget build(BuildContext context) {
    var color = Colors.amber[800];
    //Theme.of(context).primaryColor.withAlpha(180);

    return Container(
        padding: const EdgeInsets.fromLTRB(15, 35, 35, 15),
        child: Align(
            alignment: Alignment.centerRight,
            child: SizedBox(
                width: 110,
                height: 40,
                child: ElevatedButton(
                  elevation: 8,
                  padding: EdgeInsets.all(0),
                  color: color,
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(110),
                    //  side: BorderSide(color: Colors.red),
                  ),
                  //disabledColor: color,
                  //borderRadius: BorderRadius.circular(110),
                  //pressedOpacity: 0.5,
                  child: child,
                  onPressed: onPressed,
                ))));
  }
}
